<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/default_layout}">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>주식 유사종목</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    body {
      font-family: "Segoe UI", "Noto Sans KR", Arial, sans-serif;
      font-size: 0.95rem;
      margin: 0;
      background: #f3f4f6;
      color: #111827;
    }
    h2 {
      margin-top: 0;          
      margin-bottom: 0.6rem;  
      font-size: 1.2rem;      
      line-height: 1.3;       
      font-weight: 600;
      color: #111827;
    }
    .content-container {
      width: 100%;
      max-width: 1600px;
      margin: 0 auto;
      margin-top: 0.3rem;
      padding: 1rem 2%;
      box-sizing: border-box;
    }
    .dashboard-cards {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-top: 1rem;
    }
    .card {
      flex: 1 1 220px;
      display: flex;
      flex-direction: column;
      background: #fff;
      border-radius: 10px;
      padding: 16px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.06);
      min-height: 100px;
      transition: transform 0.2s;
    }
    .card:hover { transform: translateY(-2px); }
    .card-header { display: flex; align-items: center; gap: 10px; margin-bottom: 0.6rem; }
    .card-header i { font-size: 1.4rem; color: #2563eb; min-width: 28px; text-align: center; }
    .card-header h3 { margin: 0; font-size: 1rem; font-weight: 600; color: #111827; }
    .card p { margin: 0.2rem 0; font-size: 0.9rem; color: #4b5563; }
    @media (max-width: 768px) { .card { flex: 1 1 100%; } }
  </style>
</head>

<body>
<div layout:fragment="content">
  <div class="content-container">
    <h2>📊 유사 종목 차트</h2>
    <p>환영합니다! 이곳에서 유사 종목 차트를 확인할 수 있습니다.</p>
    <canvas id="stockChart" width="800" height="400"></canvas>
  </div>
</div>

<th:block layout:fragment="pageScript">
  <script th:inline="javascript">
    /* Thymeleaf JSON parse */
    let stockData = /*[[${stockData}]]*/ '[]'; 
    if(typeof stockData === 'string') {
      stockData = JSON.parse(stockData);
    }

    const ctx = document.getElementById('stockChart').getContext('2d');
    const labels = stockData.length > 0 ? stockData[0].dates : []; // 날짜 배열
    const datasets = stockData.map((item, idx) => ({
        label: item.file,
        data: item.prices, // 종가 배열
        borderColor: `hsl(${idx * 60}, 70%, 50%)`,
        fill: false
    }));

    new Chart(ctx, {
        type: 'line',
        data: { labels: labels, datasets: datasets },
        options: { responsive: true, maintainAspectRatio: false }
    });
  </script>
</th:block>
</body>
</html>
